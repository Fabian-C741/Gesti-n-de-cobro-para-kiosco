CREATE TABLE usuarios (id INT AUTO_INCREMENT PRIMARY KEY,nombre VARCHAR(100) NOT NULL,username VARCHAR(50) UNIQUE,email VARCHAR(100) UNIQUE,password VARCHAR(255) NOT NULL,user_rol ENUM('admin','vendedor','cajero') DEFAULT 'vendedor',punto_venta_id INT DEFAULT NULL,token_acceso VARCHAR(64) UNIQUE,token_usado BOOLEAN DEFAULT FALSE,activo BOOLEAN DEFAULT TRUE,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE categorias (id INT AUTO_INCREMENT PRIMARY KEY,nombre VARCHAR(100) NOT NULL,descripcion TEXT,usuario_id INT,activo BOOLEAN DEFAULT TRUE,fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE productos (id INT AUTO_INCREMENT PRIMARY KEY,codigo VARCHAR(50),nombre VARCHAR(200) NOT NULL,descripcion TEXT,precio_compra DECIMAL(10,2) DEFAULT 0,precio_venta DECIMAL(10,2) NOT NULL,stock INT DEFAULT 0,stock_minimo INT DEFAULT 0,categoria_id INT,usuario_id INT,imagen VARCHAR(255),activo BOOLEAN DEFAULT TRUE,fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE sucursales (id INT AUTO_INCREMENT PRIMARY KEY,nombre VARCHAR(100) NOT NULL,direccion VARCHAR(255),activo BOOLEAN DEFAULT TRUE) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE puntos_venta (id INT AUTO_INCREMENT PRIMARY KEY,codigo VARCHAR(20) NOT NULL,nombre VARCHAR(100) NOT NULL,sucursal_id INT,activo BOOLEAN DEFAULT TRUE) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE ventas (id INT AUTO_INCREMENT PRIMARY KEY,numero_venta VARCHAR(50),usuario_id INT NOT NULL,cliente_nombre VARCHAR(200),total DECIMAL(10,2) NOT NULL,metodo_pago VARCHAR(50) DEFAULT 'efectivo',estado VARCHAR(20) DEFAULT 'completada',fecha_venta TIMESTAMP DEFAULT CURRENT_TIMESTAMP) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE venta_detalle (id INT AUTO_INCREMENT PRIMARY KEY,venta_id INT NOT NULL,producto_id INT NOT NULL,cantidad INT NOT NULL,precio_unitario DECIMAL(10,2) NOT NULL,subtotal DECIMAL(10,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE configuracion (id INT AUTO_INCREMENT PRIMARY KEY,clave VARCHAR(100) UNIQUE NOT NULL,valor TEXT,descripcion VARCHAR(255)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
INSERT INTO sucursales (nombre,direccion,activo) VALUES ('Sucursal Principal','A configurar',1);
INSERT INTO puntos_venta (codigo,nombre,sucursal_id,activo) VALUES ('PV001','Punto de Venta 1',1,1);
INSERT INTO categorias (nombre,activo) VALUES ('Bebidas',1),('Snacks',1),('Golosinas',1),('Cigarrillos',1),('Almacén',1),('Limpieza',1),('Perfumería',1),('Varios',1);
